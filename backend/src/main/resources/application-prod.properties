#producci√≥ Fly.io 

#üöÄ Com executar correctament Producci√≥ (Fly.io):
#Fly.io ja injecta les variables d'entorn (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, JWT_SECRET, etc.)
# ‚úÖ Les variables sensibles no han d'estar escrites directament al .properties de producci√≥, es passen com a variables d'entorn
# ‚úÖ Pots tenir .env.production separat al frontend amb: VITE_BACKEND_URL=https://validacio-factures.fly.dev



# Configuraci√≥n del servidor para Docker/Fly.io
server.address=${SERVER_ADDRESS:0.0.0.0}
server.port=8080

# Directorio de uploads (legacy - para c√≥digo que a√∫n no se ha migrado a S3)
app.uploads.dir=/tmp/uploads
uploads.dir=/tmp/uploads

spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}

# Configuraci√≥n de HikariCP para acelerar el arranque
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.initialization-fail-timeout=5000
spring.datasource.hikari.connection-init-sql=SET NAMES utf8mb4
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.maximum-pool-size=3


spring.jpa.hibernate.ddl-auto=update
spring.jpa.database-platform=org.hibernate.dialect.MariaDBDialect
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true
spring.jpa.properties.hibernate.jdbc.batch_size=20



# AWS S3 Producci√≥ per la gesti√≥ de fitxers albarans i altres
aws.s3.bucket=validacio-factures-uploads
aws.accessKey=${AWS_ACCESS_KEY_ID}
aws.secretKey=${AWS_SECRET_ACCESS_KEY}



# JWT Producci√≥
jwt.secret=${JWT_SECRET}
jwt.expiration=3600000

# CORS per frontend de producci√≥
cors.allowed.origin=https://validacio-factures.vercel.app
app.client-platform.trusted-web-origins=https://validacio-factures.vercel.app
#spring.profiles.active=prod #aix√≤ no es pot posar, dona error al servidor, 

# Logging moderat en producci√≥
logging.level.root=INFO
logging.level.cat.ajterrassa.validaciofactures.filter=DEBUG

# Email Producci√≥
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=noreply.ajterrassa@gmail.com
spring.mail.password=${EMAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.ssl.protocols=TLSv1.2


# S3
aws.s3.bucket=${AWS_S3_BUCKET}
# (opcional si vols sobreescriure regi√≥ via propietat)
# aws.s3.region=eu-west-1
#parametritzem durada en que es pot veure un enlla√ß al document
s3.presign.ttl-seconds=120



# L√≠mit global per pujades multipart (Spring Boot)
spring.servlet.multipart.max-file-size=15MB
spring.servlet.multipart.max-request-size=15MB
server.tomcat.max-swallow-size=-1
#(Aix√≤ evitar√† que arribi una request massa gran. 
#Si es supera, Spring tallar√† abans d‚Äôentrar al controlador.)
#tamb√© controlem la mida d'entrada al controlador de Albarans (veure)